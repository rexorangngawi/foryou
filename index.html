<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnostic Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-main: #09090b;
            --bg-card: #18181b;
            --border-color: #27272a;
            --text-muted: #a1a1aa;
        }

        body {
            background-color: var(--bg-main);
            font-family: 'Inter', sans-serif;
            color: #f4f4f5;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        .font-mono { 
            font-family: 'JetBrains Mono', monospace; 
        }

        ::-webkit-scrollbar { 
            width: 0px; 
            background: transparent; 
        }

        .minimal-map {
            filter: invert(90%) grayscale(100%) contrast(100%) brightness(80%);
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .loading-pulse {
            animation: pulse-op 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse-op {
            0%, 100% { opacity: 1; }
            50% { opacity: .3; }
        }

        #prank-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            z-index: 99999;
        }
        
        #local-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 md:p-8">

    <div id="dashboard-ui" class="w-full max-w-3xl bg-[#18181b] border border-[#27272a] rounded-xl p-6 md:p-8 shadow-2xl transition-opacity duration-500">

        <header class="flex justify-between items-center mb-8 pb-4 border-b border-[#27272a]">
            <div class="flex items-center gap-3">
                <div class="relative flex h-2.5 w-2.5">
                    <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-blue-500"></span>
                </div>
                <h1 class="font-mono text-xs tracking-[0.2em] text-[#a1a1aa] uppercase">System Diagnostic</h1>
            </div>
            <div id="clock" class="font-mono text-[10px] md:text-xs text-[#a1a1aa]">--:--:--</div>
        </header>

        <div class="mb-8">
            <p class="text-[10px] font-mono text-[#a1a1aa] mb-2 uppercase tracking-widest">Alamat IP Publik</p>
            <h2 id="d-ip" class="text-3xl md:text-5xl font-mono text-white tracking-tight font-medium loading-pulse">Memuat...</h2>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-8 mb-8">
            
            <div class="space-y-4">
                <h3 class="text-[11px] font-semibold text-neutral-300 uppercase tracking-widest border-b border-[#27272a] pb-2">Jaringan</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <p class="text-[10px] text-[#a1a1aa] uppercase mb-1">Provider (ISP)</p>
                        <p id="d-isp" class="text-xs md:text-sm text-neutral-200 loading-pulse">...</p>
                    </div>
                    <div>
                        <p class="text-[10px] text-[#a1a1aa] uppercase mb-1">ASN</p>
                        <p id="d-asn" class="text-xs md:text-sm font-mono text-neutral-200 loading-pulse">...</p>
                    </div>
                </div>
            </div>

            <div class="space-y-4">
                <h3 class="text-[11px] font-semibold text-neutral-300 uppercase tracking-widest border-b border-[#27272a] pb-2">Lokasi</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <p class="text-[10px] text-[#a1a1aa] uppercase mb-1">Kota / Region</p>
                        <p class="text-xs md:text-sm text-neutral-200">
                            <span id="d-city" class="loading-pulse">...</span>, <span id="d-region"></span>
                        </p>
                    </div>
                    <div>
                        <p class="text-[10px] text-[#a1a1aa] uppercase mb-1">Negara / Zona Waktu</p>
                        <p class="text-xs md:text-sm text-neutral-200">
                            <span id="d-country" class="loading-pulse">...</span> <span id="d-timezone" class="text-[#a1a1aa] text-[10px] font-mono block mt-0.5"></span>
                        </p>
                    </div>
                </div>
            </div>

            <div class="space-y-4 md:col-span-2">
                <h3 class="text-[11px] font-semibold text-neutral-300 uppercase tracking-widest border-b border-[#27272a] pb-2">Perangkat</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div>
                        <p class="text-[10px] text-[#a1a1aa] uppercase mb-1">OS</p>
                        <p id="d-os" class="text-xs md:text-sm text-neutral-200 font-mono loading-pulse">...</p>
                    </div>
                    <div>
                        <p class="text-[10px] text-[#a1a1aa] uppercase mb-1">Browser</p>
                        <p id="d-browser" class="text-xs md:text-sm text-neutral-200 font-mono loading-pulse">...</p>
                    </div>
                    <div>
                        <p class="text-[10px] text-[#a1a1aa] uppercase mb-1">Resolusi</p>
                        <p id="d-res" class="text-xs md:text-sm text-neutral-200 font-mono loading-pulse">...</p>
                    </div>
                    <div>
                        <p class="text-[10px] text-[#a1a1aa] uppercase mb-1">Baterai</p>
                        <p id="d-batt" class="text-xs md:text-sm text-neutral-200 font-mono loading-pulse">...</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
            <div class="h-32 md:h-full min-h-[120px] rounded-lg bg-[#09090b] border border-[#27272a] overflow-hidden relative">
                <iframe 
                    id="gmap_canvas"
                    class="minimal-map opacity-0 transition-opacity duration-1000"
                    src="" 
                    frameborder="0" 
                    scrolling="no">
                </iframe>
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none" id="map-loading">
                    <span class="px-3 py-1 bg-black/80 text-[10px] font-mono text-[#a1a1aa] rounded border border-[#27272a]">
                        Menunggu koordinat...
                    </span>
                </div>
            </div>

            <div class="flex flex-col justify-center mt-4 md:mt-0">
                <button onclick="triggerPrank()" class="w-full bg-white hover:bg-neutral-200 active:scale-[0.98] text-black font-semibold py-4 px-6 rounded-lg transition-all duration-200 flex items-center justify-center gap-3 shadow-[0_0_20px_rgba(255,255,255,0.1)]">
                    <i class="fas fa-shield-check text-lg"></i>
                    <span class="tracking-wide">Cek Koneksi Aman</span>
                </button>
                <p class="text-center text-[9px] text-[#a1a1aa] mt-3 font-mono tracking-widest">KLIK UNTUK VERIFIKASI END-TO-END</p>
            </div>
        </div>

    </div>

    <div id="prank-overlay">
        <video id="local-video" loop>
            <source src="source.mp4" type="video/mp4">
            Browser Anda tidak mendukung tag video.
        </video>
    </div>

    <script>
        const removeLoaders = () => {
            document.querySelectorAll('.loading-pulse').forEach(el => el.classList.remove('loading-pulse'));
        };

        const updateTime = () => {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('id-ID', { hour12: false }) + " WIB";
        };
        setInterval(updateTime, 1000);
        updateTime();

        const getSystemInfo = async () => {
            const ua = navigator.userAgent;
            let os = "Unknown OS";
            if (ua.indexOf("Win") != -1) os = "Windows";
            if (ua.indexOf("Mac") != -1) os = "macOS";
            if (ua.indexOf("Linux") != -1) os = "Linux";
            if (ua.indexOf("Android") != -1) os = "Android";
            if (ua.indexOf("like Mac") != -1) os = "iOS";
            
            let browser = "Unknown";
            if (ua.indexOf("Chrome") != -1) browser = "Chrome";
            else if (ua.indexOf("Safari") != -1) browser = "Safari";
            else if (ua.indexOf("Firefox") != -1) browser = "Firefox";

            document.getElementById('d-os').innerText = os;
            document.getElementById('d-browser').innerText = browser;
            document.getElementById('d-res').innerText = `${window.screen.width}x${window.screen.height}`;

            try {
                if ('getBattery' in navigator) {
                    const battery = await navigator.getBattery();
                    document.getElementById('d-batt').innerText = Math.round(battery.level * 100) + "%";
                } else { document.getElementById('d-batt').innerText = "N/A"; }
            } catch (e) {
                document.getElementById('d-batt').innerText = "N/A";
            }
        };

        const updateUI = (data) => {
            removeLoaders();
            document.getElementById('d-ip').innerText = data.ip || 'Tidak terdeteksi';
            document.getElementById('d-isp').innerText = data.isp || 'N/A';
            document.getElementById('d-asn').innerText = data.asn || 'N/A';
            document.getElementById('d-city').innerText = data.city || '-';
            document.getElementById('d-region').innerText = data.region || '';
            document.getElementById('d-country').innerText = data.country || '-';
            document.getElementById('d-timezone').innerText = data.timezone || '';
            
            if (data.latitude && data.longitude) {
                const mapIframe = document.getElementById('gmap_canvas');
                document.getElementById('map-loading').style.display = 'none';
                mapIframe.src = `https://maps.google.com/maps?q=${data.latitude},${data.longitude}&t=&z=12&ie=UTF8&iwloc=&output=embed`;
                mapIframe.onload = () => { mapIframe.classList.remove('opacity-0'); };
            } else {
                document.getElementById('map-loading').querySelector('span').innerText = "Koordinat disembunyikan";
            }
        };

        const fetchNetworkData = async () => {
            try {
                const res = await fetch('https://ipinfo.io/json');
                if (!res.ok) throw new Error("API 1 Gagal");
                const data = await res.json();
                
                const loc = data.loc ? data.loc.split(',') : ['', ''];
                const orgParts = data.org ? data.org.split(' ') : ['N/A', 'N/A'];
                const asn = orgParts.shift(); 
                const isp = orgParts.join(' ');

                updateUI({
                    ip: data.ip,
                    isp: isp,
                    asn: asn,
                    city: data.city,
                    region: data.region,
                    country: data.country,
                    timezone: data.timezone,
                    latitude: loc[0],
                    longitude: loc[1]
                });

            } catch (error1) {
                console.log("Layer 1 gagal, mencoba Layer 2...");
                try {
                    const res2 = await fetch('https://ipwho.is/');
                    const data2 = await res2.json();
                    if (!data2.success) throw new Error("API 2 Gagal");

                    updateUI({
                        ip: data2.ip,
                        isp: data2.connection?.isp || data2.connection?.org,
                        asn: data2.connection?.asn ? `AS${data2.connection.asn}` : '-',
                        city: data2.city,
                        region: data2.region,
                        country: data2.country,
                        timezone: data2.timezone?.id,
                        latitude: data2.latitude,
                        longitude: data2.longitude
                    });

                } catch (error2) {
                    console.log("Layer 2 gagal, mencoba Layer 3...");
                    try {
                        const res3 = await fetch('https://api.db-ip.com/v2/free/self');
                        const data3 = await res3.json();
                        
                        updateUI({
                            ip: data3.ipAddress,
                            isp: "Tersembunyi (Adblock)",
                            asn: "-",
                            city: data3.city,
                            region: data3.stateProv,
                            country: data3.countryName,
                            timezone: "-",
                            latitude: null,
                            longitude: null
                        });
                    } catch (error3) {
                        removeLoaders();
                        document.getElementById('d-ip').innerText = "Diblokir Browser/Adblock";
                        document.getElementById('d-ip').classList.add('text-red-400');
                    }
                }
            }
        };

        getSystemInfo();
        fetchNetworkData();
        
        const triggerPrank = () => {
            const elem = document.documentElement;
            if (elem.requestFullscreen) elem.requestFullscreen().catch(()=>{});
            else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();

            const video = document.getElementById('local-video');
            const ui = document.getElementById('dashboard-ui');
            const overlay = document.getElementById('prank-overlay');
            video.muted = false;
            video.volume = 1.0;
            
            ui.style.opacity = "0";
            
            setTimeout(() => {
                ui.style.display = "none";
                overlay.style.display = "block";
                
                video.play().catch(e => {
                    console.log("Autoplay diblokir browser, pengguna harus klik layar.");
                });
            }, 400);
        };
    </script>
</body>
</html>


